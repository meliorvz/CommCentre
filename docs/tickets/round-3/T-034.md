# T-034: Telegram Setup Frontend

| Field | Value |
|-------|-------|
| **Status** | ðŸ”´ BLOCKED |
| **Round** | 3 |
| **Blocked By** | T-025 âœ… |
| **Effort** | 2-3 hours |
| **Assignee** | _____________ |

---

## Background

UI for connecting Telegram for escalations.

---

## Implementation

```tsx
export default function TelegramSetupStep() {
    const [deepLink, setDeepLink] = useState<string | null>(null);
    const [status, setStatus] = useState<'idle' | 'waiting' | 'connected'>('idle');
    
    const generateLink = async () => {
        const { deepLink } = await fetch('/api/telegram/setup-code', {
            method: 'POST',
        }).then(r => r.json());
        
        setDeepLink(deepLink);
        setStatus('waiting');
        pollForConnection();
    };
    
    const pollForConnection = async () => {
        // Poll status every 3 seconds
        const interval = setInterval(async () => {
            const { connected } = await fetch('/api/telegram/status').then(r => r.json());
            if (connected) {
                clearInterval(interval);
                setStatus('connected');
            }
        }, 3000);
    };
    
    return (
        <div>
            <h2>Connect Telegram</h2>
            <p>Receive urgent guest messages and escalations via Telegram</p>
            
            {status === 'idle' && (
                <Button onClick={generateLink}>Generate Connection Link</Button>
            )}
            
            {status === 'waiting' && deepLink && (
                <div>
                    <QRCode value={deepLink} />
                    <a href={deepLink}>Open in Telegram</a>
                    <p>Waiting for connection...</p>
                </div>
            )}
            
            {status === 'connected' && (
                <div className="success">
                    âœ… Telegram connected!
                    <Button href="/onboarding/complete">Continue</Button>
                </div>
            )}
        </div>
    );
}
```

---

## Acceptance Criteria

- [ ] Generate link button works
- [ ] QR code displayed
- [ ] Deep link opens Telegram
- [ ] Connection detected and displayed
- [ ] Skip option available

---

## Definition of Done

- [ ] Code reviewed
- [ ] End-to-end flow tested
- [ ] PR merged
