# T-029: Gmail OAuth Frontend

| Field | Value |
|-------|-------|
| **Status** | ðŸ”´ BLOCKED |
| **Round** | 3 |
| **Blocked By** | T-024 âœ… |
| **Effort** | 3-4 hours |
| **Assignee** | _____________ |

---

## Background

Frontend component for Gmail OAuth connection during onboarding.

---

## Implementation

```tsx
export default function GmailConnectStep() {
    const [status, setStatus] = useState<'idle' | 'loading' | 'connected'>('idle');
    const [connectedEmail, setConnectedEmail] = useState<string | null>(null);
    
    useEffect(() => {
        // Check if already connected
        fetchGmailStatus().then(({ connected, email }) => {
            if (connected) {
                setStatus('connected');
                setConnectedEmail(email);
            }
        });
    }, []);
    
    const handleConnect = () => {
        setStatus('loading');
        // Redirect to OAuth
        window.location.href = '/api/oauth/gmail/authorize';
    };
    
    if (status === 'connected') {
        return (
            <div className="connected">
                <CheckIcon /> Connected as {connectedEmail}
                <Button href="/onboarding/subscription">Continue</Button>
            </div>
        );
    }
    
    return (
        <div>
            <h2>Connect Your Email</h2>
            <p>Allow Paradise to read and send emails on your behalf</p>
            <p className="scopes">We'll request: Read, Send, Labels</p>
            <Button onClick={handleConnect} loading={status === 'loading'}>
                <GoogleIcon /> Connect Gmail
            </Button>
            <Button variant="text" href="/onboarding/subscription">
                Skip for now
            </Button>
        </div>
    );
}
```

---

## OAuth Return Handling

Handle OAuth callback redirect:

```tsx
// src/pages/onboarding/GmailCallbackPage.tsx
export default function GmailCallback({ searchParams }) {
    const status = searchParams.gmail; // 'connected' or 'error'
    
    useEffect(() => {
        if (status === 'connected') {
            router.push('/onboarding/gmail?connected=true');
        }
    }, []);
}
```

---

## Acceptance Criteria

- [ ] Connect button initiates OAuth
- [ ] Callback handled and status displayed
- [ ] Skip option available
- [ ] Error handling for OAuth failures

---

## Definition of Done

- [ ] Code reviewed
- [ ] End-to-end OAuth flow tested
- [ ] PR merged
