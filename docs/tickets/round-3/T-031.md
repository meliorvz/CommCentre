# T-031: Stripe Subscription Step

| Field | Value |
|-------|-------|
| **Status** | ðŸ”´ BLOCKED |
| **Round** | 3 |
| **Blocked By** | All P0 Security Tickets |
| **Effort** | 3-4 hours |
| **Assignee** | _____________ |

---

## Background

Subscription selection step in onboarding where users choose their plan.

---

## Implementation

```tsx
const PLANS = [
    { id: 'starter', name: 'Starter', price: 29, credits: 100 },
    { id: 'professional', name: 'Professional', price: 79, credits: 500 },
    { id: 'scale', name: 'Scale', price: 199, credits: 2000 },
];

export default function SubscriptionStep() {
    const [selectedPlan, setSelectedPlan] = useState('starter');
    
    const handleCheckout = async () => {
        const { checkoutUrl } = await fetch('/api/billing/checkout', {
            method: 'POST',
            body: JSON.stringify({ planId: selectedPlan }),
        }).then(r => r.json());
        
        window.location.href = checkoutUrl;
    };
    
    return (
        <div>
            <h2>Choose Your Plan</h2>
            <div className="plan-grid">
                {PLANS.map(plan => (
                    <PlanCard 
                        key={plan.id}
                        plan={plan}
                        selected={selectedPlan === plan.id}
                        onSelect={() => setSelectedPlan(plan.id)}
                    />
                ))}
            </div>
            <Button onClick={handleCheckout}>Start Subscription</Button>
            <Button variant="text">Start with Free Trial</Button>
        </div>
    );
}
```

---

## Acceptance Criteria

- [ ] Plan selection cards display
- [ ] Checkout redirects to Stripe
- [ ] Successful payment records subscription
- [ ] Free trial option available

---

## Definition of Done

- [ ] Code reviewed
- [ ] Stripe integration tested
- [ ] PR merged
